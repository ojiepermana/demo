(self.webpackChunkauth_etos=self.webpackChunkauth_etos||[]).push([[2461,1257],{6604:(g,h,r)=>{r.d(h,{e:()=>d});var u=r(6059),a=r(5247),e=r(2211),t=r(4946);let i=(()=>{class n{constructor(){this._user=new t.ReplaySubject(1),this._httpClient=(0,a.inject)(u.HttpClient)}set user(s){this._user.next(s)}get user$(){return this._user.asObservable()}get(){return this._httpClient.get("api/common/user").pipe((0,t.tap)(s=>{this._user.next(s)}))}update(s){return this._httpClient.patch("api/common/user",{user:s}).pipe((0,t.map)(o=>{this._user.next(o)}))}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275prov=a.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var l=r(553);let d=(()=>{class n{constructor(){this._authenticated=!1,this._httpClient=(0,a.inject)(u.HttpClient),this._userService=(0,a.inject)(i)}set accessToken(s){localStorage.setItem("accessToken",s)}get accessToken(){return localStorage.getItem("accessToken")??""}signIn(s){return this._authenticated?(0,t.throwError)("User is already logged in."):this._httpClient.post(l.N.apiUrl+"/login",{username:s.email,password:s.password,from:s.from}).pipe((0,t.switchMap)(c=>"success"===c.status?(this.accessToken=c.token.access,this._authenticated=!0,this._userService.user=c.user,(0,t.of)(c)):"failed"===c.status||"forbidden"===c.status?(0,t.of)(c):(0,t.throwError)("User is already logged in.")))}signOut(){return localStorage.removeItem("accessToken"),this._authenticated=!1,(0,t.of)(!0)}check(){return this._authenticated?(0,t.of)(!0):!this.accessToken||e.l.isTokenExpired(this.accessToken)?(0,t.of)(!1):(0,t.of)(!0)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275prov=a.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},2211:(g,h,r)=>{r.d(h,{l:()=>u});class u{static isTokenExpired(e,t){if(!e||""===e)return console.log("No token found"),!0;const i=this._getTokenExpirationDate(e);return t=t||0,null===i?(console.log("Failed to get token expiration date"),!0):(new Date).valueOf()>i.valueOf()+1e3*t||void 0}static _b64decode(e){let i="";if((e=String(e).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let d,n,l=0,v=0;n=e.charAt(v++);~n&&(d=l%4?64*d+n:n,l++%4)?i+=String.fromCharCode(255&d>>(-2*l&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i}static _b64DecodeUnicode(e){return decodeURIComponent(Array.prototype.map.call(this._b64decode(e),t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))}static _urlBase64Decode(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("Illegal base64url string!")}return this._b64DecodeUnicode(t)}static _decodeToken(e){if(!e)return null;const t=e.split(".");if(3!==t.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const i=this._urlBase64Decode(t[1]);if(!i)throw new Error("Cannot decode the token.");return JSON.parse(i)}static _getTokenExpirationDate(e){const t=this._decodeToken(e);if(!t.hasOwnProperty("exp"))return null;const i=new Date(0);return i.setUTCSeconds(t.exp),i}}},553:(g,h,r)=>{r.d(h,{N:()=>u});const u={production:!0,apiUrl:"https://indonusa.auth.etos.ojie.dev",logo:"https://angular.io/assets/images/logos/angular/angular.svg",theme:"theme-brand"}},2461:(g,h,r)=>{r.r(h),r.d(h,{SIGN_OUT_MFE_ROUTES:()=>s});var u=r(8620),a=r(5919),e=r(4946),t=r(5247),i=r(6604);function l(o,c){if(1&o&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"i18nPlural"),t.\u0275\u0275elementContainerEnd()),2&o){const m=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" Redirecting in ",t.\u0275\u0275pipeBind2(2,1,m.countdown,m.countdownMapping)," ")}}function d(o,c){1&o&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1," You are now being redirected! "),t.\u0275\u0275elementContainerEnd())}const n=o=>["/sign-in",o],s=[{path:":from",component:(()=>{class o{constructor(m,p,f){this._activatedRoute=m,this._authService=p,this._router=f,this.countdown=5,this.countdownMapping={"=1":"# second",other:"# seconds"},this._unsubscribeAll=new e.Subject}ngOnInit(){this.from=this._activatedRoute.snapshot.paramMap.get("from"),this._authService.signOut(),(0,e.timer)(1e3,1e3).pipe((0,e.finalize)(()=>{this._router.navigate(["sign-in",this.from])}),(0,e.takeWhile)(()=>this.countdown>0),(0,e.takeUntil)(this._unsubscribeAll),(0,e.tap)(()=>this.countdown--)).subscribe()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}static#t=this.\u0275fac=function(p){return new(p||o)(t.\u0275\u0275directiveInject(a.ActivatedRoute),t.\u0275\u0275directiveInject(i.e),t.\u0275\u0275directiveInject(a.Router))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["auth-sign-out"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:15,vars:6,consts:[[1,"flex","flex-col","flex-auto","items-center","sm:justify-center","min-w-0"],[1,"w-full","sm:w-auto","py-8","px-4","sm:p-12","sm:rounded-2xl","sm:shadow","sm:bg-card"],[1,"w-full","max-w-80","sm:w-80","mx-auto","sm:mx-0"],[1,"w-12","mx-auto"],["src","assets/images/logo/logo.svg"],[1,"mt-8","text-4xl","font-extrabold","tracking-tight","leading-tight","text-center"],[1,"flex","justify-center","mt-0.5","font-medium"],[4,"ngIf"],[1,"mt-8","text-md","font-medium","text-secondary","text-center"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"]],template:function(p,f){1&p&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.\u0275\u0275element(4,"img",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",5),t.\u0275\u0275text(6),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",6),t.\u0275\u0275template(8,l,3,4,"ng-container",7)(9,d,2,0,"ng-container",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(10,"div",8)(11,"span"),t.\u0275\u0275text(12,"Go to"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(13,"a",9),t.\u0275\u0275text(14,"sign in "),t.\u0275\u0275elementEnd()()()()()),2&p&&(t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate1("",f.from," out"),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",f.countdown>0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",0===f.countdown),t.\u0275\u0275advance(4),t.\u0275\u0275property("routerLink",t.\u0275\u0275pureFunction1(4,n,f.from)))},dependencies:[u.NgIf,a.RouterLink,u.I18nPluralPipe],encapsulation:2})}return o})()}]}}]);